<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Bangladeshi Graduate Student Association | The Ohio State University</title>
  <meta name="description"
    content="The Bangladeshi Graduate Student Association (BGSA) at The Ohio State University fosters community, cultural exchange, and professional networking among Bangladeshi graduate students, alumni, and researchers." />

  <link rel="stylesheet" href="css/style.css" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap"
    rel="stylesheet" />

  <!-- ✅ SheetJS Library for reading Excel files -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>

<body>
  <!-- HEADER -->
  <header class="header">
    <div class="header__content">
      <div class="header__logo-container">
        <div class="header__logo-img-cont">
          <img src="./assets/png/tOSU_BGSA_logo.png" alt="BGSA at The Ohio State University Logo"
            class="header__logo-img" />
        </div>
        <span class="header__logo-sub">BGSA @ tOSU</span>
      </div>

      <div class="header__main">
        <ul class="header__links">
          <li class="header__link-wrapper"><a href="#home" class="header__link">Home</a></li>
          <li class="header__link-wrapper"><a href="#about" class="header__link">About</a></li>
          <li class="header__link-wrapper"><a href="#news" class="header__link">News</a></li>
          <li class="header__link-wrapper"><a href="#gallery" class="header__link">Gallery</a></li>
          <li class="header__link-wrapper"><a href="#database" class="header__link">Database</a></li>
          <li class="header__link-wrapper"><a href="#executive" class="header__link">Executive Members</a></li>
          <li class="header__link-wrapper"><a href="#contact" class="header__link">Contact</a></li>
        </ul>

        <div class="header__main-ham-menu-cont">
          <img src="./assets/svg/ham-menu.svg" alt="hamburger menu" class="header__main-ham-menu" />
          <img src="./assets/svg/ham-menu-close.svg" alt="hamburger menu close"
            class="header__main-ham-menu-close d-none" />
        </div>
      </div>
    </div>
  </header>

  <!-- HERO (unchanged) -->
  <section id="home" class="home-hero">
    <div class="home-hero__content">
      <h1 class="heading-primary">Bangladeshi Graduate Student Association (BGSA)</h1>
      <div class="home-hero__info">
        <p class="text-primary">The Ohio State University</p>
      </div>
      <div class="home-hero__cta">
        <a href="#about" class="btn btn--bg">Learn More</a>
      </div>
    </div>
  </section>

  <!-- ABOUT (unchanged) -->
  <section id="about" class="about sec-pad">
    <div class="main-container">
      <h2 class="heading heading-sec heading-sec__mb-med">
        <span class="heading-sec__main">About BGSA</span>
        <span class="heading-sec__sub">
          The Bangladeshi Graduate Student Association (BGSA) at The Ohio State University is a student-led
          organization committed to fostering community, collaboration, and cultural exchange among Bangladeshi
          graduate students, alumni, and researchers.
        </span>
      </h2>
    </div>
  </section>

  <!-- DATABASE -->
  <section id="database" class="projects sec-pad">
    <div class="main-container">
      <h2 class="heading heading-sec heading-sec__mb-med">
        <span class="heading-sec__main">Member Database</span>
        <span class="heading-sec__sub">
          Automatically loads from the BGSA Excel member file and displays it dynamically.
        </span>
      </h2>

      <div class="database__actions" style="text-align:center; margin-bottom: 2rem;">
        <a href="https://forms.gle/your-bgsa-form-link" target="_blank" class="btn btn--med btn--theme">
          Add / Update Your Info
        </a>
      </div>

      <!-- Search bar -->
      <div class="database__search" style="text-align:center; margin-bottom:2rem;">
        <input type="text" id="searchInput" placeholder="Search by name or program..."
          style="padding:1rem; width:60%; max-width:400px; border-radius:5px; border:1px solid #ccc; font-size:1.6rem;">
      </div>

      <!-- Table -->
      <div class="database__table-container" style="overflow-x:auto;">
        <table id="members-table" style="width:100%; border-collapse:collapse; text-align:left;">
          <thead>
            <tr style="background-color:#BA0C2F; color:#fff;">
              <th style="padding:1rem;">First Name</th>
              <th style="padding:1rem;">Last Name</th>
              <th style="padding:1rem;">Degree</th>
              <th style="padding:1rem;">Program</th>
              <th style="padding:1rem;">Name.#</th>
            </tr>
          </thead>
          <tbody id="members-body"></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- FOOTER (unchanged) -->
  <footer class="main-footer">
    <div class="main-container">
      <div class="main-footer__lower">
        &copy; <span id="year"></span> BGSA @ The Ohio State University. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- ✅ Excel to JSON Loader Script -->
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    async function loadExcelAndRender() {
      try {
        // Load Excel file (must be in same folder)
        const response = await fetch("./assets/csv/database.xlsx");
        const arrayBuffer = await response.arrayBuffer();

        // Parse with SheetJS
        const workbook = XLSX.read(arrayBuffer, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const data = XLSX.utils.sheet_to_json(sheet);

        // DOM elements
        const tableBody = document.getElementById("members-body");
        const searchInput = document.getElementById("searchInput");

        // Render function
        function renderTable(filterText = "") {
          tableBody.innerHTML = "";
          data
            .filter(member =>
              Object.values(member).some(value =>
                String(value).toLowerCase().includes(filterText.toLowerCase())
              )
            )
            .forEach(member => {
              const row = document.createElement("tr");
              row.innerHTML = `
                <td style="padding:1rem; border-bottom:1px solid #ddd;">${member["First Name"] || ""}</td>
                <td style="padding:1rem; border-bottom:1px solid #ddd;">${member["Last Name"] || ""}</td>
                <td style="padding:1rem; border-bottom:1px solid #ddd;">${member["What degree are you currently pursuing/ what degree did you complete at tOSU?"] || member["Degree"] || ""}</td>
                <td style="padding:1rem; border-bottom:1px solid #ddd;">${member["Name of the program/department"] || member["Program"] || ""}</td>
                <td style="padding:1rem; border-bottom:1px solid #ddd;">${member["tOSU Name.#"] || member["Name.#"] || ""}</td>
              `;
              tableBody.appendChild(row);
            });
        }

        renderTable();
        searchInput.addEventListener("input", e => renderTable(e.target.value));

      } catch (err) {
        console.error("Error loading Excel file:", err);
      }
    }

    loadExcelAndRender();
  </script>

</body>

</html>